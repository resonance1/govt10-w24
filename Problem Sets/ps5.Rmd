---
title: "Problem Set 5"
author: ""
output:
  pdf_document: default
---

```{r setup, echo=F}
library(knitr)
opts_chunk$set(tidy.opts = list(width.cutoff = 60), tidy = TRUE)
knitr::opts_chunk$set(error = TRUE)
```

# 1: Data wrangling

This week, we covered more commands to manipulate datasets. In this exercise, we will practice manipulating data on the ideological positions of United States Supreme Court Justices.  Just like legislators, justices make voting decisions that political scientists use to estimate their ideological positions (ideal points)
  
```{r}
library(tidyverse)
justices <- read.csv("./data/justices.csv", stringsAsFactors = FALSE)

#download.file("https://raw.githubusercontent.com/resonance1/govt10-w24/main/Problem%20Sets/data/justices.csv","justices.csv")
#justices <- read.csv("justices.csv", stringsAsFactors = FALSE)


```

| Name     | Description                                 |
|----------|---------------------------------------------|
| term     | Supreme Court term                          |
| justice  | Justice's family name                       |
| idealpt  | Justice's estimated ideal point             |
| pparty   | Political party of the nominating president |
| pres     | President's name                            |

Negative ideal points indicate liberal leanings and positive ideal points indicate conservative leanings. 

1.1 Do Presidents who are a Democrat/Republican have a Supreme Court that is more liberal/conservative on average?

```{r}

```
*1 sentence here*

1.2. Calculate the median ideal point of the justices _during each term_ of the Court, and save it as a new dataset called _points_. 

```{r}

```

1.3. Next, use your new dataset to plot the change in the median ideal point over time. The Supreme Court term should appear on the x-axis, and the median ideal point for each term should appear on the y-axis. What do the results suggest about the median ideological position of Supreme Court judges over time?

```{r}

```

*1 sentence here*

1.4. Identify the name of the Supreme Court justice with the median ideal point for each term. These judges are often the 'swing judges' who effectively determine policy. 

_Note: There are 2 ways of doing this. Here are some pointers to get you started down the right path_

Option 1:
Use  %>% group_by %>% filter() 

Option 2:
a. Merge the _points_ dataset (with the median values) to the _justices_ dataset using left join(), and save the merged dataset as a new dataset
b. Use filter() on the dataset produced in #1 to retrieve only those rows that match the median ideal point in that year.

```{r}


```



# 2: Poll Averages and Election Predictions 


We will evaluate data from the 2016 Presidential Election, which featured Trump vs. Clinton. The election date was the 8th of November, 2016.

```{r}
library(tidyverse)
library(lubridate)
polls16 <- read.csv("./data/polls16.csv") 
pres16 <- read.csv("./data/pres16.csv")


#download.file("https://raw.githubusercontent.com/resonance1/govt10-w24/main/Problem%20Sets/data/polls16.csv","polls16.csv")
#polls16 <- read.csv("polls16.csv")


#download.file("https://raw.githubusercontent.com/resonance1/govt10-w24/main/Problem%20Sets/data/pres16.csv","pres16.csv")
#pres16 <- read.csv("pres16.csv")

```

2.1 In the polls16 dataset, create two variables that measure the number of days until the election date (days_until), and the polling margin, which we will define as (Clinton-Trump). In the pres16 dataset, create a variable that measures the actual voting margin.

```{r}

```

2.2 Filter the polls16 dataset to only include those that sample the population of "likelyvoters", with a sample size greater than 200. 

```{r}

```


2.3 Now, create a new version of the dataset that contains  only polls conducted within 15 days of the last poll within each state. For instance, if the last poll in State A was conducted 3 days prior to the election, your dataset should include all polls conducted on days 18 through 3 for State A. If the last poll in State B was conducted 5 days prior to the election, your polls from this state should be drawn from days 5 through 20, etc.

_Note: There are 2 ways of doing this. Here are some pointers to get you started down the right path_

Option 1:
Use  %>% group_by %>% filter() 

Option 2:
a. Create a new dataset called _latest_ that contains the most recent poll in each state, and use select() to extract just the state abbreviation and the _days_until_ value for the most recent poll.
b. Use %>% rename(lastpoll=days_until) on the results from #1 to rename _days_until_ into a new column called _lastpoll_
c. Merge the results of #2 back into the polls16 dataset, and filter to contain only polls within x days of _lastpoll_

```{r}


```

2.4 Start with your dataset containing all polls conducted within 15 days of the last poll, which you created in the previous question. Now, extract the average of the polls within each state, and save it as a new dataset called _averaged_polls_ . Merge the _averaged_polls_ and the _pres16_ dataset together into a new dataset called _merged.16_. 

```{r}

```

2.5 Using the _merged.16_ dataset, assess the relationship between the actual voting margin (y) and the polling margin (x) using a bivariate regression model. Obtain and interpret the regression coefficients. What do they tell you about the relationship of the polls to the actual election results in 2016? 

```{r}

```

*A few sentences here*

2.6 Let's examine whether other variables can potentially improve our prediction and reduce polling bias. The following dataset contains state-level demographic data:

```{r}
demographics <- read.csv("./data/demographics.csv")


#download.file("https://raw.githubusercontent.com/resonance1/govt10-w24/main/Problem%20Sets/data/demographics.csv","demographics.csv")
#demographics <- read.csv("demographics.csv")
```

Filter the demographics dataset to 2016 only. Then create a new variable in the dataset called _under45_ that contains the proportion of residents who are 45 years or younger. Next, merge this dataset with your existing _merged.16_ dataset using left_join(): 

```{r}

```

2.7 Using the master dataset, fit two regressions: first, regress the actual voting margin in each state (y) on the `Male' variable (x), which measures the share of residents who are Male (0 to 100 scale). Second, regress the actual voting margin in each state (y) on the _under45_ variable (x). Interpret the coefficients from each regression as well as the R^2.

```{r}

```

*A few sentences here*

2.8 Now fit a multivariate regression model using three independent variables: Male, under45, and the 15-day poll margin according to the most recent state poll(s). While we have not covered the syntax in class, it is simple, use  _lm(y~ x1 + x2 + x3)_ , where y is the outcome, and x1, x2, and x3 are the independent variables. Interpret the R^2 in words. Then compare the R^2 between the multivariate model and the bivariate model calculated in 2.7. Does adding this additional information improve the predictive power of the model? 

```{r}

```

*2 sentences here*


Please submit using Canvas